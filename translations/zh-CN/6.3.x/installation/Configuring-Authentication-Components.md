---
layout: 默认
title: CAS-配置身份验证组件
category: 验证
---

# 配置

CAS身份验证过程主要由身份验证管理器控制，该管理器负责协调身份验证处理程序的集合。

## 认证管理器

CAS随附一个单一但灵活的身份验证管理器，该管理器根据以下合同执行身份验证。

对于任何给定的凭证，管理器都将执行以下操作：

1. 遍历所有已配置的身份验证处理程序。
2. 如果处理程序支持该证书，则尝试对其进行身份验证。
3. 成功后，尝试解决一个主体。
  1. 检查是否为对凭据进行身份验证的处理程序配置了解析程序。
  2. 如果找到合适的解析器，请尝试解析主体。
  3. 如果找不到合适的解析程序，请使用身份验证处理程序解析的主体。
4. 检查是否满足安全策略（例如，任何安全策略）。
  1. 如果符合安全策略，请立即返回。
  2. 如果不符合安全策略，请继续。
5. 在尝试了所有凭据之后，再次检查安全策略，如果不满意 `AuthenticationException`

有一个隐式安全策略，要求至少一个处理程序成功认证凭据。

要查看CAS属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#authentication-policy)。

## 身份验证处理程序

CAS支持多种身份验证处理程序和方法。 使用菜单浏览站点并选择。

<div class="alert alert-warning"><strong>默认凭证</strong><p>为了测试在CAS缺省的认证方案，
使用 <strong>casuser</strong> 和 <strong>梅隆</strong> 分别作为用户名和密码。 这些都是自动
通过静态认证处理程序配置，以及 <strong>MUST</strong> 从配置中移除
在生产之前的推出。</p></div>

要查看CAS属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#accept-users-authentication)。

### 行政端点

CAS提供了以下端点：

| 终点                       | 描述                                                                                           |
| ------------------------ | -------------------------------------------------------------------------------------------- |
| `authenticationHandlers` | `GET` 请求提出了已注册身份验证处理程序的集合。 可以使用选择器路径（即 `authenticationHandlers /{name}`） `GET` 查询单个身份验证处理程序。 |

### 解决策略

身份验证处理程序通常是全局定义的，然后由身份验证引擎执行和尝试。 可以使用选择标准来缩小处理程序的集合的范围，该选择标准基于当前的身份验证事务，提供的凭据，服务定义策略 和许多其他控件

要查看CAS属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#authentication-engine)。

#### 每次注册服务

可以为注册表中的每个已注册应用程序分配一组标识符/名称，以供在CAS中可用和配置 这些名称可用于强制执行服务定义，以在将身份验证请求提交给CAS时

请 [本指南](../services/Configuring-Service-AuthN-Policy.html) 以了解更多信息。

#### Groovy脚本

身份验证处理程序的全局集合也可以通过Groovy脚本作为过滤器 传递，以缩小当前事务的候选者列表。 脚本的大纲可以设计为：

```groovy
def run（Object [] args）{
    def处理器= args[0]
    def事务= args[1]
    def servicesManager = args[2]
    def logger = args[3]

    返回处理器
}

def support（Object [] args）{
    def处理程序= args[0]
    def事务= args[1]
    def servicesManager = args[2]
    def logger = args[3]
    true
}
```

以下参数传递到脚本：

| 范围                | 描述                                   |
| ----------------- | ------------------------------------ |
| `处理程序`            | 可用和候选 `AuthenticationHandler`s的集合。   |
| `交易`              | 身份验证事务当前正在进行中。                       |
| `servicesManager` | `ServicesManager` 对象负责查找附加到此事务的服务定义。 |
| `记录器`             | 负责发布日志消息的对象，例如 `logger.info（...）`。   |

脚本的结果应该是选择的处理程序的集合，类型为 `Set<AuthenticationHandler>`。

### 认证顺序

在运行时，CAS维护着一组身份验证处理程序/策略，通常一个接一个地执行。 每个提供一种身份验证策略形式的CAS模块都将在 引导时间将其自身简单地插入到该集合中。 在此过程结束时，将收集所有身份验证事务的结果，并可选地由 身份验证策略处理，其中可以考虑某些策略/源的成功/失败，以完全满足 身份验证要求。 身份验证处理程序的集合尝试以一种更具确定性的方式来保留顺序。 想法是采用者可以将 `阶` 值分配给身份验证处理程序，从而将其显式放置在 集合中并控制其执行顺序。

### 命名策略

可以通过CAS设置来命名CAS中的每个身份验证处理程序，如果未定义，则使用处理程序组件本身 `LdapAuthenticationHandler`）。 名称本身可以是任意字符串，通常使用 来标识和引用处理程序组件，例如 [](../services/Configuring-Service-AuthN-Policy.html)必要身份验证等。 在多种认证的处理程序事件 *相同类型的* 被定义，它是 **推荐** ，每个被赋予一个唯一的名称，以避免冲突。 身份验证失败通常是通过每个身份验证处理程序的名称在CAS中收集的。 保留未定义的名称可能会导致身份验证链中的后续组件覆盖先前的结果。

## 认证政策

CAS提供了许多用于处理身份验证安全策略的策略。 通常，策略控制以下内容：

1. 某种身份验证失败后是否应该停止身份验证链？
2. 给定链中有多个身份验证处理程序，什么构成成功的身份验证事件？

通常在以下情况下激活策略：

1. 身份验证失败。
2. 身份验证链已完成执行。

身份验证策略的典型用例可能包括：

1. 强制执行特定的身份验证，以使整个身份验证事件都被视为成功。
2. 确保特定类型的故障在身份验证链的执行日志中不明显。
3. 确保将链中的所有身份验证方案都成功执行，以使整个身份验证事件都被视为成功。

要查看CAS属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#authentication-policy)。

### 行政端点

CAS提供了以下端点：

| 终点       | 描述                                                                                       |
| -------- | ---------------------------------------------------------------------------------------- |
| `身份验证政策` | `GET` 请求提出了已注册身份验证策略的集合。 可以使用选择器路径（即 `authenticationPolicies /{name}`） `GET` 查询单个身份验证策略。 |

## 主要决议

请 [请参阅本指南](Configuring-Principal-Resolution.html) 有关主体分辨率的更多详细信息。

### 主体转化

可以配置通常处理用户名密码凭证 身份验证处理程序，以在执行身份验证序列之前转换用户ID。 CAS中的每种身份验证策略都提供了正确转换主体的设置。 有关手头认证策略，请参阅相关设置以了解更多信息。

## 长期认证

CAS支持长期票证授予票证，此功能也称为 _“记住我”_ 以将SSO会话的长度扩展到典型配置之外。 请 [参阅本指南](Configuring-LongTerm-Authentication.html) 了解更多详情。

## 代理验证

请 [参阅本指南](Configuring-Proxy-Authentication.html) 了解更多详情。

## 多因素身份验证（MFA）

请 [参阅本指南](../mfa/Configuring-Multifactor-Authentication.html) 了解更多详情。

## 登录限制

CAS提供了一种限制登录失败尝试的功能，以支持密码猜测和相关的滥用情况。 有关登录限制的更多详细信息，请 [请参阅本指南](Configuring-Authentication-Throttling.html)

## SSO会话Cookie

授予票证的cookie是CAS在建立单点登录会话时设置的HTTP cookie。 该cookie维护客户端的登录状态，并且在有效期间，客户端可以将其提交给CAS代替主要凭证。 请 [参阅本指南](Configuring-SSO.html) 了解更多详细信息。
