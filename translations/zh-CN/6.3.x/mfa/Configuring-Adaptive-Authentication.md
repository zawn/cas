---
layout: 违约
title: CAS - 自适应认证
category: 多因素认证
---

# 自适应身份验证

CAS 中的自适应身份验证允许您根据客户端浏览器和/或设备 某些特征接受或拒绝身份验证请求。 配置时，您可以选择阻止某些浏览器代理提交的某些位置 的身份验证请求。 例如，您可能会认为从 `伦敦、英国` 提交的 身份验证请求被视为可疑，或者您可能想要阻止来自 Internet Explorer 等提交的请求。

自适应身份验证也可以根据特定日期和时间配置为触发多因素。 例如，您可能希望在选定的日期触发多因素，或者当前时间是晚上 11 点以后或早上 6 点之前。 每个规则块可以分配给 mfa 提供商，其中规则的成功匹配允许执行多因素触发器。

## 配置

要查看 CAS 属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#adaptive-authentication)。

要启用自适应身份验证，您需要允许 CAS 进行地理定位身份验证请求。 欲了解更多，请 [本指南](../installation/GeoTracking-Authentication-Requests.html)

## 知识产权情报

CAS 为您提供了检查客户端 IP 地址并决定是否授予访问权限的能力。 这可能是有用的 检测机器人，代理或VPN流量，并保护您的部署免受欺诈，自动攻击，爬行器等。

IP 地址检查的结果可以禁止和请求请求、允许请求通过，也可以 提供分数，以指示可能可疑的 IP 地址的概率。 如果结果为排名分数，则将与配置的风险阈值 进行比较，以确定请求是否可以继续。

禁止的 IP 地址可以定义为 CAS 设置中的模式，也可以使用下面列出的策略对其进行检查。

### 休息

客户端 IP 地址将提交到 REST 端口，因为标题 `客户端地址根据 <code>获取` 请求</code> 。 预期结果状态代码如下：

| 法典           | 描述                                                    |
| ------------ | ----------------------------------------------------- |
| `401`， `403` | IP 地址被禁止，请求将被拒绝。                                      |
| `200`， `202` | 允许使用 IP 地址，请求可以继续。                                    |
| 所有其他         | 响应机构预计将包含 `1` 和 `0`（`1+禁止` 和 `0+允许`）之间的分数，表明 IP 地址可疑。 |

### 槽的

客户端 IP 地址可以使用 Groovy 脚本进行检查，其大纲应与以下内容相匹配：

```groovy
进口组织. apereo. cas. 认证.
进口组织. apereo. cas. 认证. *
进口组织. apereo. cas. 使用. *
进口组织. apereo. cas. 认证. 自适应. 英特尔. *

def 运行 （对象 [] args） =
    def 请求康泰克斯 [args[0]
    定义客户地址=args[1]
    def 记录器 = args[2]
    logger.info（"提供的客户 ip 地址 ${clientIpAddress}"）

    （ipAdadadresre）
        返回 IP 地址智能回复。禁止（）

    返回 IP 地址智能回复。允许（）
}
```

### 黑点 IP 英特尔

有关详细信息，请 [](https://getipintel.net/) 查看此链接。 大型查询计数需要有效的订阅。

<div class="alert alert-warning"><strong>使用警告！</strong><p>这是一项免费服务，主要用于开发、测试和演示。 此服务 
的生产部署需要订阅，以便处理预期的查询计数和负载。</p></div>

请注意，经常检查的有效电子邮件必须在联系人字段中使用，否则服务可能会在未通知的情况下被禁用。 此外， **不要** 超过 每天超过500个查询 & 每分钟15个查询。 有关更多信息，请参阅 [常见问题解答](https://getipintel.net/#FAQ) 。

# 基于风险的身份验证

CAS 能够跟踪和检查可疑行为的认证请求。 要了解更多，请 [本指南](../installation/Configuring-RiskBased-Authentication.html)。
