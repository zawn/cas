---
layout: default
title: CAS - 升级指南
category: 概览
---

# 升级指南

一般来说，建议使用者尽量保持其 CAS 部署与最新的 CAS 版本保持一致。 尤其是，应尽快升级 `PATCH` 或 `SECURITY` 性质的发行版，他们是你当前版本的最佳替代。 有关更多信息，请参见CAS [发布策略](../../developer/Release-Policy.html)

CAS升级的总体目标可能是：

1. 升级是否解决了严重的安全漏洞或烦人的问题？我的CAS部署是否受到该漏洞或错误的影响？
2. 升级是否提供了对本地用例有用的功能的实现？
3. 升级是否提供了在我的本地叠加层中实现的功能，例如，通过消除这些本地更改，我可以直接从CAS中受益，并最终得到一个较小的，更易于维护的叠加层？

本文档试图从一个很高的层次描述升级给定的[CAS部署](../installation/WAR-Overlay-Installation.html)所需的范围和工作。 而不是描述为了进行审查和调整所需的具体步骤/更改（这是不可能的），我们描述的是可以执行升级的策略。

## 更改日志

尝试升级之前，请查看 [CAS更改日志](https://github.com/apereo/cas/releases) 以确定您打算升级到的版本中包含哪些更改/修复，以及这些更改/修复是否适用于您的环境和您的CAS部署。 如果您使用的是较旧的CAS版本，并且似乎遇到的是BUG，你有可能通过查看更改日志，找到一个直接替代的叠加层，从而可以解决问题。

## 讨论问题

查看了更改日志后，如果没有发现你想象中对功能改进的修复/调整，请在适当的CAS邮件列表上讨论该问题。 讨论的结果将是进行范围/工作评估，以确定解决方案的可行性和完成解决方案的目标版本。

## 范围审查

一旦你决定了你升级的理想CAS版本，在尝试升级之前请查看CAS [发行策略](../../developer/Release-Policy.html)。 这将使您了解您可能期望从新版本中得到哪些更改，以及升级可能需要付出哪些努力。

## 评估本地叠加

作为最佳实践，建议您通过 [覆盖方法](../installation/WAR-Overlay-Installation.html)部署CAS。 如果你是这样做的话，这里的任务将是确定叠加层中你接触和修改的文件数。 记录你应用这些修改的原因和修改了那些内容，并使用CAS更改日志差分对比这些修改。 升级的结果很有可能是，在你覆盖层中出现的许多本地更改都是通过CAS默认提供的，这将使您在摆脱许多本地的这些改进。

您所做的更改通常是：

* 身份验证方案和策略（即LDAP，JDBC等）
* 在CAS属性文件中设置并控制CAS的行为
* 用户界面更改可能包括CSS和JavaScript
* 用户属性解析和发布策略
* CAS中服务的注册和授权

## 准备开发环境

<img src="http://i.imgur.com/jcdDHWb.jpg" width="160px" height="200px" />

嗯，不

请确保您有一个单独的开发环境可以进行配置和测试。 不管升级有多小，您都应确保在生产部署之前在您的环境中对它进行了良好的测试。 评估新升级的软件依赖关系和平台需求(如Java等)，并确保在尝试之前正确安装和配置了所有东西。

## 清理配置

我们建议您首先针对你要升级到的版本创建一个单独的干净 [CAS覆盖](../installation/WAR-Overlay-Installation.html) 。 这样做的好处是可以保证您的新CAS部署在不进行任何本地更改的情况下正常工作。 进行一次干净的CAS覆盖的构建和部署，以确保构建/部署过程是正常的。

## 应用更改

认真检查在你的本地叠加层中更改。 比较并差分这些文件与原始版本的差异。 你可以通过以下方法对两个版本进行差分:

1. 如果你已经进行了一次干净的CAS覆盖，你将自动获得原始版本，通常在CAS覆盖的`target`或`build/libs`目录。 在正确的路径中找到正确的文件并进行比较。

2. 直接转到 [项目源存储库](https://github.com/apereo/cas)，找到适当的分支 并比较文件。

不用说，您将需要：

1. 体面的比较工具，如[KDiff3](http://kdiff3.sourceforge.net/), [WinDiff](http://winmerge.org), [Beyond Compare](http://www.scootersoftware.com/)等
2. 体面智能文本编辑器，如 [Sublime](http://www.sublimetext.com), [Atom](https://atom.io/) 或者一个成熟的IDE，例如 [IntelliJ IDEA](https://www.jetbrains.com/idea/).

## 文件变更

请记住要记录本地覆盖层中存在的其余更改，以便下次执行相同的过程时，您就有了关于为什么覆盖层看起来是这样的线索。 
