---
layout: 违约
title: CAS - J 米性能测试
category: 高可用性
---

# J 仪性能测试

Apache JMeter 是一种出色的性能测试工具，在 Java 社区中大量使用。

## 安装仪表

* Linux 和 Mac：
  * 下载J米二进制文件。
    * [http://jmeter.apache.org/download_jmeter.cgi](http://jmeter.apache.org/download_jmeter.cgi)
  * 解压阿帕奇 - jmeter - *. tgz 到您的首选位置
  * 运行 `箱/里程表.sh`
    * 注意：Mac用户还可以使用流行的家庭布鲁包管理器来安装JMeter。
* 窗户：
  * 以下是窗口设置的教程。
    * [https://toolsqa.com/jmeter/download-and-installation-jmeter/](http://toolsqa.com/jmeter/download-and-installation-jmeter/)

## 示例测试脚本

下面你会发现三个通用的可运行登录脚本的三个最流行的CAS实现口味。 请随时编辑和使用您的需求。

虽然脚本支持不同的登录方法，但它们确实具有一些共同的特点。

## 常见设置选项卡

* _用户定义变量_
  * _线程计数_ - 线程数（有点像用户）。  建议从100个用户左右开始。
  * _持续时间_ - 测试应运行多长时间。  通常，线程（用户）越多，持续时间就越长
  * _Rampupperiod_ - 需要多长时间才能升级到全套线程计数
* _线程组_ （或测试）：
  * _循环计数_ -#循环，或更正确的#用户运行通过测试。
    * 计数将与将运行通过测试的总用户关联
    * _永远_ 复选框将循环通过文件，并保持到手动停止或直到达到持续时间 从"用户定义的变量"页面
* _CSV获取用户/密码_：
  * 包含测试用户凭据的文件的名称和位置
  * 应采用 `用户、密码`格式，在"用户"、"逗号"和"密码"之间没有空格

**脚本**

脚本可以从 [这里下载](https://github.com/apereo/cas/raw/master/etc/loadtests/)。

* **_CAS_CAS. jmx_**
  * 使用标准 CAS 登录过程安装 CAS 的香草
  * 无需 SP（服务提供商）
  * 用户定义变量：
    * _Idphost_ - 您的 Cas 实例的 Url
    * _卡斯普_ - SP（服务提供商）URL，但不必处于活动状态
  * 测试片段：
    * _GET - CAS 登录页面_ - 访问典型 CAS 登录的登录页面
    * _职位 - 登录凭据_ - 将用户文件的凭据发布到 CAS 实例
    * _获取-用户信息与服务票_ -获取用户信息与服务票，CAS生成时，用户登录
      * 根据断言，可能需要更新预期的用户结果
    * _GET - 用户注销_ - 通过 CAS 注销从 CAS 会话的注销用户
* **_CAS_Oauth. jmx_**
  * 支持非授权登录过程的CAS
  * 活动 SP 是可选的
  * 脚本反映了使用 OAuth 的最常见方式，即授权代码方法
  * _用户定义变量_：
    * _Idphost_ - 您的 Cas 实例的 Url
    * _卡斯普_ - SP（服务提供商）URL，但不必处于活动状态
    * _斯普克莱恩迪德_ - CAS 服务文件中 SP 的客户端
    * _斯普雷杜里_ - SP 中的终点，用于接收"授权代码"
    * _斯普州_ - 使用CSRF令牌
    * _斯普克莱恩特_ - 用于身份验证的非真实呼叫类型
    * _Sp 响应类型_ - 正在使用的非授权方法，在此例中代表"授权代码"的"代码"
    * _斯普克莱特秘密_ - SP 和 CAS 之间共享的秘密短语或单词
  * _测试片段_：
    * _验证服务提供商_ -- 验证网址到 SP 是正确的（可选，可禁用）
    * _开始 CAS 登录过程_ - 访问具有所有参数设置的 OAuth 的 CAS 登录页面
    * _1a-1d_ - 为用户发布登录凭据，然后重定向以获取访问令牌中的代码
      * 由于测试时的编码问题而分为多个过程
    * _获取-用户配置文件与访问令牌_ -致电CAS获取用户的信息与访问令牌
      * 根据断言，可能需要更新预期的用户结果
    * _GET - 用户注销_ - 通过 CAS 注销从 CAS 会话的注销用户
* **_CAS_SAML2. jmx_**
  * CAS 支持 SAML2 登录过程
  * 需要一个活跃的SP！
    * 对于此测试使用简单萨姆帕普
  * _用户定义变量_：
    * _卡斯普_ - 使用 Saml 注册的 Cas Sp 域名
    * _提供商id_ - SP元数据中注述的SAML实体ID
  * _测试片段_：
    * _转到SP的CAS登录_ -SP页面受SAML2保护，将重定向到CAS登录端点
    * _帖子 - 登录用户_ - 将用户文件的凭据发布到 CAS SAML2 登录
    * _邮政 - CAS 授权 SP_ - 从 CAS 向 SP 发送响应以进行处理和最终请求以获取用户信息
      * 可能需要更新断言才能返回成功的用户信息
    * _GET - 用户注销_ - 通过 CAS 注销从 CAS 会话的注销用户

## 运行测试脚本

一旦您将测试脚本保存到您的系统中。 您可以在GUI JMeter内运行，也可以通过命令行运行。 他强烈建议 GUI 用于 故障排除脚本，以便在您的环境中工作。 然后，当您实际开始 负载测试时，您可以通过命令行进行加载测试。

要从命令行类型激活 JMeter GUI：

```bash
提示$/usr/本地/箱/计量器
```

此路径应对应于您选择安装 Jmeter 的位置。

通过命令行启动 JMeter 的简单示例：

```bash
提示$/usr/本地/箱/计-n-t your_script.jmx
```

`-n` 非GUI模式运行J米。 `-t` 条通往.jmx测试文件的路径。

更多的例子可以在</a>Jmeter站点找到。</p>
