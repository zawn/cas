---
layout: 违约
title: 动态主题 - 用户界面定制 - CAS
category: 用户界面
---

# 动态主题

随着 [服务管理应用](../services/Service-Management.html)的推出，部署人员现在能够根据不同的服务 切换主题。 例如，您可能需要为员工应用程序和学生应用程序提供不同的登录屏幕（不同样式），或者要显示两个 布局，用于白天和黑夜。 此文档可以帮助您通过基本设置来实现此目的。

## 静态主题

CAS 的配置是根据服务注册处特定注册服务的 `主题` 属性来装饰视图。 通过此方法激活的主题仍将保留 CAS 的默认视图，但将在视图中应用 CSS 和 Javascript 等装饰。 无法通过此方法修改视图的物理结构。

### 配置

- 添加 `[theme_name].属性` 放置在 `src/主/资源` 文件夹的根部。 此文件的内容应匹配以下内容：

```properties 
•主题CSS文件路径
cas.标准.css.文件=/主题/[theme_name]/css/cas.css

主题JS文件路径
cas.标准.js.文件]/主题/[theme_name]/js/cas.js

布局
# cas.logo.file]/图像/徽标.png     

# 决定抽屉菜单是否应该显示
# cas.抽屉菜单.启用]真实                    

# 主题名称用于各种标题/标题
# cas.

.
#cas.favicon.file=/主题/示例/图像/法维肯.ico

启用并显示通知菜单
# cas.通知-菜单.启用]真实

# 启用和显示抽屉菜单
# cas.抽屉菜单。
```

- 创建目录 `src/主/资源/静态/主题/[theme_name]`。 将主题特定的 `.css` 和 `cas.js` 放入适当的目录内 `css` 和 `js`。
- 根据 `主题` 属性指定服务定义 `[theme_name]` 。

```json
•
  "@class"："org.apereo.cas.服务.注册服务"，
  "服务id"："^https://www.example.org"，
  "名称"："我的主题"，
  "主题"："[theme_name]"，
  "id"：1000
}
```

值可以使用 [弹簧表达语言](../configuration/Configuration-Spring-Expressions.html) 语法。

## 主题视图

CAS还可以利用服务的相关主题，选择哪组UI视图将用于生成 标准视图（`卡罗金视图.html`等）。 对于针对不同类型的受众 的主题的一组页面在结构上完全不同的情况下，这特别有用，即使用简单主题不实际来增加默认视图。 在这种情况下，可能需要新的视图页面。

默认情况下，与特定主题相关联的视图预计在： `src/主/资源/模板/<theme-id>`。 请注意，CAS 视图和基于主题的视图都可以从 Web 应用上下文中外部化。 当外部化时，主题视图将通过 CAS 属性在指定路径上找到，该目录以主题命名的 目录下。 例如，如果 CAS 视图的外部路径 `/等/cas/模板`，则 主题 `样本` 的视图模板文件可能位于 `/等/cas/模板/样本/`。

要查看 CAS 属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#views)。

### 配置

- 添加 `[theme_name].属性` 放置在 `src/主/资源` 文件夹的根部。 此文件的内容应匹配以下内容：

```properties
cas.标准.css.文件=/主题/[theme_name]/css/cas.css
案例标准.js.文件=/主题/[theme_name]/js/cas.js
```

- 将默认的视图集页克隆到基于主题 ID 的新目录中（即 `src/主/资源/模板/<theme-id>`）。
- 根据 `主题` 属性指定您的主题名称，以定义服务。

## 主题集合

CAS 提供了一个模块，提供许多现成的主题。 每个主题的意图 考虑到共同的，并规定共同使用的情况下，当涉及到用户界面修改 和样品，并试图自动化的大部分配置。

支持通过在 WAR 叠加中包括以下模块来启用：

```xml
<dependency>
     <groupId>组织.apereo.cas</groupId>
     <artifactId>的卡-服务器-支持-主题-集合</artifactId>
     <version>${cas.version}</version>
</dependency>
```

本模块提供以下主题，可分配给服务定义：

| 主题  | 描述                       |
| --- | ------------------------ |
| `例` | 结合自定义 CSS、爪哇脚本和视图的参考示例主题 |

以上主题的集合还可以作为如何定义主题的参考示例， 自定义CSS、Javascript以及相关视图和片段。

## 格罗夫主题

如果您定义了多个主题，则最好动态确定给定服务定义的主题。 为了做到这一点，您可以通过您自己设计的 Groovy 脚本计算最终的主题名称。 分配给服务定义的主题需要指向脚本的位置：

```json
•
  "@class"："org.apereo.cas.服务.注册服务"，
  "服务id"："^https://www.example.org"，
  "名称"："我的主题"，
  "主题"："file:///etc/cas/config/themes.groovy"，
  "id"：1000

```

脚本本身可设计为：

```groovy
导入java.利用。*

def字符串运行（最终对象。。。args）{
    def服务=args[0]
    def注册服务=args[1]
    def查询串=args[2]
    def标题=args[3]
    定义记录器=args[4]

    //确定主题。。。

    返回无效
}
```

返回 `无效` 或空白将有CAS切换到默认主题。 以下参数可传递到 Groovy 脚本：

| 参数     | 描述                                |
| ------ | --------------------------------- |
| `服务`   | 表示请求服务的对象。                        |
| `注册服务` | 表示注册表中匹配注册服务的对象。                  |
| `查询弦`  | 请求中发现的所有查询字符串的文本表示（如果有的话）。        |
| `头`    | `地图` 请求中发现的所有请求标题及其值（如果有的话）。      |
| `记录`   | 负责发布日志消息的对象，如 `logger.info（。。。）`。 |

## 主题十足

与上述选项有些类似，您可以通过自己设计的 REST 终点计算最终主题名称。 分配给服务定义的主题需要指向 REST API 的位置。 端点必须设计为通过获取</code> 请求 `接受/处理 <code>申请/json` 。 返回的状态代码 `200` 允许 CAS 读取响应的主体以确定主题名称。 空响应机构将有CAS切换到默认主题。

```json
•
  "@class"："org.apereo.cas.服务.注册服务"，
  "服务id"："^https://www.example.org"，
  "名称"："我的主题"，
  "主题"："https://themes.example.org"，
  "id"：1000

```

以下参数可传递到 Groovy 脚本：

| 参数   | 描述       |
| ---- | -------- |
| `服务` | 请求服务标识符。 |
