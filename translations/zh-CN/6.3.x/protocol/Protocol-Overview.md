---
layout: 默认
title: CAS-协议概述
category: 通讯协定
---

# 协议概述

CAS支持并提供以下协议：

*   [中国科学院](CAS-Protocol.html)
*   [OpenID](OpenID-Protocol.html)
*   [OAuth](OAuth-Protocol.html)
*   [OpenID连接](OIDC-Protocol.html)
*   [WS联合会](WS-Federation-Protocol.html)
*   [SAML1](SAML-Protocol.html)
*   [SAML2](../installation/Configuring-SAML2-Authentication.html)
*   [REST协议](REST-Protocol.html)

## 设计

CAS将自己呈现为支持诸如CAS，SAML2，OAuth2和OpenID Connect等协议的多语言平台。 由于出色的社区反馈和采用，对每个协议的支持和功能在软件的每次迭代和发行中都不断得到改进。 尽管几乎所有此类协议的性质和意图都是相似的，但它们都有各自特定的绑定，参数，有效负载和安全性要求。 本节提供有关CAS中如何支持现有协议的快速介绍。

一切始于一个相当琐碎的东西：The Bridge。

### 桥

桥接器 *设计模式* 是一种中间人位于客户端和服务器之间，来回转换请求的方法。 它只是充当双方之间的链接，允许翻译，整理和转换来自客户端的身份验证请求，然后“无形地”将其路由到CAS，然后再返回。

这是一个巧妙的技巧，因为客户端不在乎身份验证请求在提交后如何处理。 接收到该请求的 *事物* （充当桥接器）可以执行任何处理该请求并最终向客户端提交某种响应的操作。 桥接器也不在乎外部认证系统将处理和兑现该请求以及所有内部处理如何工作。 桥所关心的是，“我将请求路由到X。只要X将正确的东西还给我，我就可以继续。”

因此，桥梁大部分是操作的“控制塔”。 它讲多种语言和协议，并且像任何体面的翻译一样，它了解每种语言的怪癖和细节，因此能够动态翻译技术术语。

### 支持的协议

如果你理解了上面的策略，那么你会很高兴地得知， *几乎* 中科院支持的所有协议与完全相同的用心经营。 给定的CAS部署配备了嵌入式插件/桥/模块，这些插件知道如何说SAML2和CAS，OAuth2和CAS或OpenID Connect和CAS或其他内容。 例如，当考虑使用支持OAuth2的客户端应用程序进行以下身份验证流程时，该等式的右侧始终为CAS：

1. CAS部署已打开OAuth2插件。
2. OAuth2授权请求将提交到相关的CAS端点。
3. OAuth2插件会验证该请求并将其转换为CAS身份验证请求！
4. 身份验证请求将路由到相关的CAS登录端点。
5. 用户进行身份验证并将CAS路由回OAuth2插件，并为其发布了服务票证。
6. OAuth2插件尝试验证该票证以检索必要的用户个人资料和属性。
7. 然后，OAuth2插件通过将配置文件和经过验证的断言转换和转换为客户端应用程序可能需要的内容，继续发出正确的OAuth2响应。

<div class="alert alert-info"><strong>笔记</strong><p>如果CAS决定将身份验证委派给外部身份提供者（如Facebook或SAML2身份提供者），则上述策略完全相同。</p></div>

该流程的右侧始终是CAS，因为该插件始终会将协议请求转换为CAS请求。 另一种看待它的方式是，所有协议插件和模块本身都是CAS服务器的客户端！ 它们会获得服务票证，并且像其他任何启用CAS的客户端一样会继续对其进行验证。 就像上面一样，对于启用了OAuth2的客户端，所有此类详细信息都是完全透明的，只要“正确的东西”返回给客户端，它就不会在乎。

这种方法有一些内部技术和体系结构优势。 即：

CAS验证引擎的核心，流程和组件根本不需要修改。 毕竟，我们只是在集成另一个客户端，即使该客户端直接嵌入到CAS本身中也是如此。 因此，如果需要，可以很容易地删除对该协议的支持。 毕竟，协议每天都会来来去去。 最后，就像任何其他CAS客户端一样，CAS服务器的所有功能都随时可用，并且可以转换为相关的客户端，从而消除了尽可能重复和重新创建特定于协议的配置的需要。 诸如访问策略，属性释放，用户名提供者之类的东西。
