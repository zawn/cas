---
layout: 违约
title: CAS - 属性定义
category: 属性
---

# 属性定义

CAS 中属性的定义，当从身份验证或属性存储库源中提取和解决时，往往 定义，并使用其名称进行引用，而没有任何额外的 *元数据* 或装饰。 例如，您可能需要检索 `uid` 属性，并几乎 重命名并映射为 `用户标识符` 属性，无论是全球还是特定应用集成。 对于大多数使用案例，此配置 工作得相当舒适，但是，根据目标应用程序的性质和用于完成集成的认证协议，可以施加 附加要求，并且可能需要指定使用附加指点定义属性，当与 依赖方共享和发布时。 例如，SAML2 服务提供商可能需要一个 *范围的* 属性，用于 `eduPersonPrinal name` 其价值 始终由具有特殊友好名称的 `uid` 属性确定，无论目标应用程序如何，该属性始终提供。

虽然有关给定属性的元数据位和部分可以在 的 CAS 配置设置中在全球定义，也可以在服务定义中定义，但属性定义存储允许一个人描述有关必要属性的元数据， 在属性解析和发布过程中需要考虑特殊装饰。 属性定义存储的规格完全 可选，并且存储可能不包含任何属性定义。

要查看 CAS 属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#attribute-definitions)。

## 杰森属性定义

属性定义可在 JSON 文件中定义，该文件的位置通过 CAS 设置提供。 JSON 文件 的结构可能与以下情况相匹配：

```json 
•
    "@class"："爪哇。利用。树图"，
    "员工id"：{
      "@class"："org.apereo.cas.认证.属性.属性"，
      "密钥"："员工ID"，
      "范围"：真实、
      "属性"："empl_identifier"
    =

```

属性定义使用 `映射` 其关键是属性名称，由 CAS [属性分辨率引擎](Attribute-Resolution.html)解决。 属性名称作为 `映射` 的键必须与属性定义本身的 `键` 属性匹配。

属性定义可以指定以下设置：

| 名字     | 描述                                                |
| ------ | ------------------------------------------------- |
| `钥匙`   | 属性名称，由 CAS [属性分辨率引擎](Attribute-Resolution.html)解决 |
| `名字`   | 属性名称将在属性发布期间与目标应用程序使用和共享。                         |
| `范围`   | （可选）如果 `真正的`，属性值将范围定位于设置中定义的 CAS 服务器部署范围。         |
| `加密`   | （可选）如果 `真实`，则属性值将使用服务定义的公钥在 base-64 中加密和编码。       |
| `属性`   | （可选）源属性为属性定义本身提供值，取代了原始源的值。                       |
| `模式形式` | （可选） `java.text.消息表中使用的模板` 来装饰属性值。                |
| `脚本`   | （可选）Groovy 脚本，外部或嵌入处理和生成属性值。                      |

如果属性定义是为了生成值，则应按给出的顺序执行以下操作：

- 根据属性定义中指定的 `属性` 设置生成属性值（如果有）。
- 根据属性定义中指定的 `脚本` 设置生成属性值（如果有的话）。
- 根据属性定义中指定的 `范围` 设置生成属性值（如果有）。
- 根据属性定义中指定的 `模式` 设置生成属性值（如果有的话）。
- 根据属性定义中指定的加密</code> 设置 `生成属性值（如果有）。</li>
</ul>

<h2 spaces-before="0">例子</h2>

<h3 spaces-before="0">基本</h3>

<p spaces-before="0">定义 <code>员工的属性定义id` 根据另一个属性 `empl_identifier` 作为来源 生成范围属性：</p>

```json 
•
    "@class"："爪哇。利用。树图"，
    "员工id"：{
      "@class"："org.apereo.cas.认证.属性.属性"，
      "密钥"："员工ID"，
      "范围"：真实、
      "属性"："empl_identifier"
    =

```

现在，该定义已在全球可用，则属性 [可以像往常一样](Attribute-Release-Policies.html) 发布，定义如下：

```json
...
  "属性释放政策"： [
    "@class"： "org. apereo. cas. 服务. 返回允许的属性释放政策"，
    "允许属性"： [java. util. Arraylist"， [员工" ]
  ]
...
```

### 加密属性

与上述使用案例相同，但属性值除外，将使用服务定义的公钥进行加密和编码：

```json 
•
    "@class"："爪哇。利用。树图"，
    "员工id"：{
      "@class"："org.apereo.cas.认证.属性"，
      "密钥"："员工ID"，
      "加密"：真实、
      "属性"："empl_identifier"
    =

```

服务定义应指定一个公共关键定义：

```json
...
  "公共钥匙"：{
    "@class"："org.apereo.cas.服务.注册服务"，
    "位置"："类路径：公共.key"，
    "算法"："RSA"
  =
。。。
```

密钥可以通过以下命令生成：

```bash
打开斯尔根萨 - 出私人.key 1024
打开斯尔 rsa - 酒吧 - 在私人.key - 出公共.key - 通知 Pem - 超越 Der
打开 pkcs8 - topk8 - 通知每 - 通知佩尔 - 诺克里普特 - 在私人.key - 出私人. p8
```

### 模式格式

定义属性定义，以根据模式格式生成值：

```json 
•
    "@class"： "java. util. treemap"，
    "爱德华森原则名"： [
      "@class"： "org. apereo. cas. 认证. 属性. 默认属性定义"，
      "钥匙"："爱德华人原则名称"，
      "姓名"："urn：oid：1.3.6.1.4.1.5923.1.1.1.6"，
      "友好姓名"："爱德华人姓名"，
      "范围"：真实，
      "模式形式"："你好，{0}"，
      "属性"："uid"
    }
}
```

如果已解决的属性集 `uid=[测试1， test2]` 和CAS服务器具有 `example.org`的范围， `爱德华个人主名` 的最终值将是[`hello,test1@example.org`，`hello,test2@example.org`] 发布为 `u oid：1.3.6.1.4.1.5923.1.1.1.6` 友好名称 `爱德华·佩尔森`。

### 嵌入式脚本

与上述使用案例相同，但属性值除外，由嵌入式 Groovy 脚本进行附加处理

```json 
•
    "@class"： "java. util. treemap"，
    "爱德华个人原则名"： [
      "@class"： "org. apereo. cas. 认证. 属性. 默认属性定义"，
      "键"："eduPerson原则名称"，
      "名称"："urn：oid：1.3.6.1.4.1.5923.1.1.1.6"，
      "友好名称"："eduPerson原则名称"，
      "范围"：真实，
      "脚本"："凹凸不清{logger.info（\"名称： ${attributeName}，价值观： ${attributeValues} "）;返回['你好'，'世界']]]"
    [
]
```

如果 CAS 服务器具有 `example.org`范围，则 `eduPerson 主名` 的最终值将是 [`hello@example.org`、 `world@example.org`] 以 `骨灰盒：oid 发布 ：1.3.6.1.4.1.5923.1.1.1.6` ，友好名称为 `爱德华·佩尔森`。

### 外部脚本

与上述使用案例相同，但属性值除外，则由外部 Groovy 脚本进行附加处理：

```json 
•
    "@class"： "java. util. treemap"，
    "爱德华个人原则名"： [
      "@class"： "org. apereo. cas. 认证. 属性. 默认属性定义"，
      "键"："爱德华人原则名称"，
      "名称"："urn：oid：1.3.6.1.4.1.5923.1.1.1.6"，
      "友好名称"："教育个人主名"，
      "范围"：真实，
      "脚本"："文件：/属性定义。groovy"
    =
}
```

Groovy 脚本的大纲应定义为：

```groovy
def运行（对象[]args）{
    def属性名称=args[0]
    d值=args[1]
    def记录器=args[2]
    logger.info（"名称： ${attributeName}，值： ${attributeValues}"）
    返回["卡苏瑟"，"凹槽"]
}
```

如果 CAS 服务器具有 `example.org`的范围，则 `eduPerson 主名` 的最终值将是 [`casuser@example.org`、 `groovy@example.org`] 发布为 `骨灰盒：oid： 1.3.6.1.4.1.5923.1.1.1.6` ，友好名称为 `教名`。
