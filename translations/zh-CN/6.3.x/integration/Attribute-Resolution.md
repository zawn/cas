---
layout: 违约
title: CAS - 属性分辨率
category: 属性
---

# 属性分辨率

属性解析策略由 [人员目录项目](https://github.com/apereo/person-directory) 控制。 人员目录依赖性会自动与 CAS 服务器捆绑。 因此，不需要 宣布额外的依赖。 此人员目录项目支持 LDAP 和 JDBC 属性解析、 缓存、来自多个属性源的属性聚合等。

<div class="alert alert-info"><strong>默认缓存策略</strong><p>默认情况下，
属性缓存到 SSO 会话的长度。
这意味着，虽然"人员目录"提供的基础组件可能
不同的缓存模型，但默认属性以及从
CAS 透视不会在后续请求中刷新和检索，只要 SSO 会话存在
。</p></div>

## 行政终点

CAS 提供以下端点：

| 端点            | 描述                                                          |
| ------------- | ----------------------------------------------------------- |
| `解决归因/{name}` | 调用 CAS [属性分辨率](Attribute-Resolution.html) 引擎来定位 `{name}`属性。 |

## 人员目录

从各种基础来源解决人员和属性的框架。 它包括从 JDBC、LDAP 等处检索、缓存、解析、聚合 合并人员属性的组件集合。

有关处理解决委托人的中科院物业名单，请 [本指南](../configuration/Configuration-Properties.html#principal-resolution)。

属性源被定义和配置，以描述每个经过验证的委托人 提取的全球属性集。 然后， 服务经理根据特定于服务的属性发布规则对该全球属性集进行筛选。

请注意，每个属性存储库源可以分配一个唯一的标识符用于其他筛选。 "人目录"提供的属性解析引擎 也可以配置为只征用并非全部，而是选择属性存储库源， *推迟* 身份验证过程后期属性检索的任务 ，例如</a>

发布属性。</p>

<div class="alert alert-info"><strong>主要决议</strong><p>请注意，在大多数（如果不是全部）情况下，
CAS 认证能够检索和解决身份验证源中的属性，这将
消除配置单独的解析器的需要，特别是如果身份验证和属性源相同。
只有在来源不同或需要处理更高级的属性时，才需要使用单独的解析器，
解决使用案例，如级联、合并等。 <a href="../installation/Configuring-Principal-Resolution.html">有关详细信息，请参阅本指南</a> 。</p></div>

解析器的目标是为 CAS 构建最终可识别的认证本金，其中载有多个属性。 人目录解析器的行为是试图定位主 ID，这在大多数情况下与身份验证期间提供的凭据 ID 相同，或者可以通过自定义属性进行记录。 然后，解析器开始从定义的属性存储库构建属性。 如果它意识到使用自定义属性来确定主 ID，并且将相同的属性设置为收集到最终属性集中，则它将从最终集合中删除该属性。

请注意，默认情况下，CAS 会自动创建适合 LDAP、JDBC 等的属性存储库源。 如果你需要更多的东西，你将需要诉诸更详细的措施来定义豆配置。

要查看 CAS 属性的相关列表，请 [查看本指南](../configuration/Configuration-Properties.html#authentication-attributes)。 有关人物目录及其可配置来源的更多信息， [可在此处找到](https://github.com/apereo/person-directory)。



### 京城

CAS 确实允许从各种 SQL 数据库中检索属性。 要了解如何配置数据库驱动程序， [请参阅本指南](../installation/JDBC-Drivers.html)。

JDBC 属性源可以根据以下机制进行定义：



#### 单行

设计用于对一个表工作，其中有一行映射到一个用户。 此表格式的一个示例是：

| 乌伊德    | first_name | last_name | 电子邮件                 |
| ------ | ---------- | --------- | -------------------- |
| `杰史密斯` | `约翰`       | `史密斯`     | `jsmith@example.org` |




#### 多行

设计用于对一个表工作，其中有一行映射到一个用户。 此表格式的一个示例是：

| 乌伊德    | attr_name    | attr_value           |
| ------ | ------------ | -------------------- |
| `杰史密斯` | `first_name` | `约翰`                 |
| `杰史密斯` | `last_name`  | `史密斯`                |
| `杰史密斯` | `电子邮件`       | `jsmith@example.org` |


您需要定义配置中 列映射，以将 `attr_name` 列映射到 `attr_value` 列



## 例子

假设 CAS 被配置为针对活动目录进行身份验证。 详细信息定义在 以下的帐户通过 `个 sAM 帐户名`进行身份验证。

| 属性       | 价值       |
| -------- | -------- |
| `萨姆帐户名`  | `约翰史密斯`  |
| `快递 之 家` | `约翰·史密斯` |




### 示例#1

如果将解析器配置为使用 `sAMAccoutname` 作为主 ID 的属性，则当身份验证完成时，解析器尝试 从属性存储库源构建属性，它将 `sAMAccoutname` 视为属性，并认为主 ID 由 `sAMAccout 名`创建。 因此，它将从属性中删除 `个 sAMAcout 名` 。 最终的结果是一个校长，他的ID是 `约翰史密斯` 谁有一个 `cn` 属性 `约翰史密斯`。



### 示例#2

如果将解析器配置为使用 `cn` 作为主 ID 的属性，则当身份验证完成时，解析器尝试从属性存储库源 构建属性。 然后，它将 `sAMAcout 名称为` 属性，并看到主 ID 将由 `cn`创建。 因此，它将从属性中删除 `cn` 。 最终的结果是一个校长，他的身份证是 `约翰史密斯` 谁有一个 `sAM帐户名` 属性 `约翰史密斯`。



## 属性定义

CAS 属性可以附加元数据进行装饰，这些元数据以后可以根据协议的 要求以及与目标应用程序集成的性质使用。 要了解更多 ，请 [本指南](Attribute-Definitions.html)。
